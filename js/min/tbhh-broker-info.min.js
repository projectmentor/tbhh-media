/* tbhh-broker-info.js - Minified 2025-09-15_104414 */
{window.tbhhBrokerInfo=window.tbhhBrokerInfo||{};const o="[TBHH BrokerInfo]";let n=null;window.tbhhBrokerInfo.detectSubdomain=()=>{const o=window.location.hostname.split(".");return o.length>2?{isSubdomain:!0,subdomain:o[0]}:{isSubdomain:!1,subdomain:null}},window.tbhhBrokerInfo.getBrokerInfo=()=>{const n=window.tbhhConfig.CDN_BASE_MEDIA,i=window.tbhhConfig,r=i.AGENT_CONFIG,e=i.BROKER_CONFIG;if(!r||!r.domains)throw console.error(`${o} Missing AGENT_CONFIG.domains in configuration`),new Error("Invalid agent configuration structure");console.log(`ðŸ” ${o} Using media CDN base:`,n),console.log(`ðŸ” ${o} Current hostname:`,window.location.hostname);const t=window.tbhhBrokerInfo.detectSubdomain();let a;if(t.isSubdomain){if(r.domains.subdomains&&r.domains.subdomains[t.subdomain])a=r.domains.subdomains[t.subdomain].agentId;else if(a=r.domains.default?.agentId,!a)throw console.error(`${o} Missing default agentId in configuration`),new Error("Default agent not configured")}else if(a=r.domains.main?.agentId,!a)throw console.error(`${o} Missing agentId for main domain in configuration`),new Error("Main domain agent not configured");const d=r.agents&&r.agents[a];if(!d)throw console.error(`${o} Agent '${a}' not found in configuration`),new Error(`Agent ${a} not configured`);const s=e&&e[d.brokerId];if(!s)throw console.error(`${o} Broker '${d.brokerId}' not found in configuration`),new Error(`Broker ${d.brokerId} not configured`);const l={agentId:d.id||a,name:d.name,phone:d.phone,email:d.email,title:d.title,brokerId:d.brokerId,brokerName:s.name,brokerShortName:s.shortName,logo:s.logo};return{...l,logo:l.logo?`${n}${l.logo}`:null}},window.tbhhBrokerInfo.init=()=>{try{if(!window.tbhhConfig)return console.warn(`${o} Configuration not available. Cannot initialize broker info.`),null;console.log(`âœ… ${o} Initializing agent info module...`);const i=window.tbhhConfig;if(!i.AGENT_CONFIG||!i.AGENT_CONFIG.domains)return console.error(`${o} Invalid AGENT_CONFIG structure. Missing domains property.`),null;const r=window.tbhhBrokerInfo.detectSubdomain(),e=window.tbhhBrokerInfo.getBrokerInfo();return n={isSubdomain:r.isSubdomain,subdomain:r.subdomain,agentId:e.agentId,name:e.name,phone:e.phone,email:e.email,title:e.title,brokerId:e.brokerId,brokerName:e.brokerName,brokerShortName:e.brokerShortName,logo:e.logo},console.log(`âœ… ${o} Agent info set:`,e.name,`(${e.brokerName||e.brokerShortName||""})`,r.isSubdomain?`(subdomain: ${r.subdomain})`:"(main domain)"),console.log(`âœ… ${o} Agent info module initialized`),n}catch(n){return console.error(`${o} Error initializing broker info:`,n),null}},window.tbhhBrokerInfo.getBrokerData=()=>(n||(n=window.tbhhBrokerInfo.init()),!n&&window.tbhhConfig&&(console.log(`${o} Config now available, retrying initialization...`),n=window.tbhhBrokerInfo.init()),n)}